#!/usr/bin/env python3\n\"\"\"\n🎰 BETWAY CASINO REVIEW - LIVE WORDPRESS PUBLISHING\nUniversal RAG CMS v6.3 - PUBLISH TO CRASHCASINO.IO\n\"\"\"\n\nimport asyncio\nimport os\nimport sys\nfrom datetime import datetime\nfrom pathlib import Path\n\n# Add the src directory to Python path\nsys.path.insert(0, str(Path(__file__).parent / 'src'))\n\n# Import the Universal RAG Chain\nfrom chains.universal_rag_lcel import create_universal_rag_chain\n\nasync def publish_betway_review_live():\n    \"\"\"\n    Generate and publish a comprehensive Betway casino review to WordPress\n    \"\"\"\n    print(\"🎰 BETWAY CASINO REVIEW - LIVE WORDPRESS PUBLISHING\")\n    print(\"=\" * 60)\n    \n    # WordPress credentials from memory\n    wordpress_config = {\n        'site_url': 'https://www.crashcasino.io',\n        'username': 'nmlwh',\n        'app_password': 'q8ZU 4UHD 90vI Ej55 U0Jh yh8c'\n    }\n    \n    print(f\"📝 Target WordPress Site: {wordpress_config['site_url']}\")\n    print(f\"👤 Publishing as: {wordpress_config['username']}\")\n    \n    # Create production chain with WordPress publishing enabled\n    print(\"🚀 Initializing Universal RAG Chain with WordPress publishing...\")\n    chain = create_universal_rag_chain(\n        enable_hyperlink_generation=True,  # ✅ Hyperlinks enabled\n        enable_wordpress_publishing=True,  # ✅ WordPress enabled  \n        enable_comprehensive_web_research=True,  # ✅ 95-field analysis\n        enable_dataforseo_images=True,     # ✅ Images enabled\n        model_name=\"gpt-4.1-mini\",\n        temperature=0.1\n    )\n    \n    # Initialize WordPress properly\n    if hasattr(chain, 'wordpress_publisher') and chain.wordpress_publisher:\n        try:\n            # Configure WordPress manually if auto-init failed\n            chain.wordpress_publisher.site_url = wordpress_config['site_url']\n            chain.wordpress_publisher.username = wordpress_config['username'] \n            chain.wordpress_publisher.app_password = wordpress_config['app_password']\n            print(\"✅ WordPress credentials configured manually\")\n        except Exception as e:\n            print(f\"⚠️ WordPress configuration warning: {e}\")\n    \n    # Generate comprehensive Betway casino review\n    query = \"\"\"Create a comprehensive Betway casino review for 2025 covering all essential aspects:\n    - Licensing and regulatory compliance \n    - Game selection and software providers\n    - Bonus offers and promotional terms\n    - Payment methods and withdrawal speeds\n    - Security features and player protection\n    - Mobile compatibility and user experience\n    - Responsible gambling tools\n    - Overall rating and recommendation\n    \n    Include actionable insights, pros/cons, and FAQ section.\"\"\"\n    \n    print(f\"📝 Query: {query[:100]}...\")\n    print(\"⚡ Processing with ALL 13 features including hyperlink generation...\")\n    \n    start_time = datetime.now()\n    \n    try:\n        # Generate the comprehensive review\n        response = await chain.ainvoke({'query': query})\n        \n        end_time = datetime.now()\n        processing_time = (end_time - start_time).total_seconds()\n        \n        print(f\"\\n✅ GENERATION COMPLETE!\")\n        print(f\"📄 Content Length: {len(response.answer):,} characters\")\n        print(f\"🎯 Confidence Score: {response.confidence_score:.3f}\")\n        print(f\"⏱️ Processing Time: {processing_time:.2f} seconds\")\n        print(f\"📚 Sources Used: {len(response.sources)}\")\n        \n        # Check for hyperlinks\n        hyperlink_count = response.answer.count('<a href=\"http')\n        print(f\"🔗 Hyperlinks Embedded: {hyperlink_count}\")\n        \n        # Show sample hyperlinks\n        if hyperlink_count > 0:\n            print(\"\\n🔗 SAMPLE HYPERLINKS:\")\n            import re\n            links = re.findall(r'<a href=\"(https?://[^"]+)\"[^>]*>([^<]+)</a>', response.answer)\n            for i, (url, text) in enumerate(links[:5], 1):\n                print(f\"  {i}. [{text}]({url})\")\n        \n        # Save the article locally\n        timestamp = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\n        filename = f\"betway_published_{timestamp}.md\"\n        \n        with open(filename, 'w', encoding='utf-8') as f:\n            f.write(response.answer)\n        \n        print(f\"\\n💾 Article saved locally: {filename}\")\n        \n        # Check if WordPress publishing succeeded\n        wordpress_published = False\n        if response.metadata.get('wordpress_published'):\n            wordpress_url = response.metadata.get('wordpress_url', ''\n            print(f\"\\n🚀 WORDPRESS PUBLISHING SUCCESS!\")\n            print(f\"📝 Article URL: {wordpress_url}\")\n            print(f\"🏷️ Categories: {response.metadata.get('wordpress_categories', [])}\")\n            print(f\"🔖 Tags: {response.metadata.get('wordpress_tags', [])}\")\n            wordpress_published = True\n        else:\n            print(f\"\\n⚠️ WordPress publishing was not completed\")\n            print(f\"📄 Article generated successfully but not published to WordPress\")\n            print(f\"💡 Reason: WordPress configuration may need adjustment\")\n        \n        # Summary\n        print(f\"\\n\" + \"=\"*60)\n        print(f\"🎯 BETWAY CASINO REVIEW SUMMARY\")\n        print(f\"=\"*60)\n        print(f\"✅ Content Generated: {len(response.answer):,} characters\")\n        print(f\"✅ Hyperlinks Added: {hyperlink_count}\")\n        print(f\"✅ Processing Time: {processing_time:.2f}s\")\n        print(f\"✅ Confidence Score: {response.confidence_score:.3f}\")\n        print(f\"{'✅' if wordpress_published else '⚠️'} WordPress Published: {'YES' if wordpress_published else 'NO'}\")\n        print(f\"📁 Local File: {filename}\")\n        \n        return response\n    \n    except Exception as e:\n        print(f\"\\n❌ ERROR during generation: {e}\")\n        return None\n\nif __name__ == \"__main__\":\n    asyncio.run(publish_betway_review_live())\n 